{"version":3,"file":"commonHelpers2.js","sources":["../src/main-1.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport fetchQuery from './js/pixabay-api';\nimport render from './js/render-functions';\nimport { iconSuccess, iconError } from './js/components';\nimport './css/styles.css';\n\nconst refs = {\n  formSearch: document.getElementById('search-form'),\n  gallery: document.querySelector('.gallery'),\n  btnLoad: document.querySelector('button[type=\"button\"]'),\n  loader: document.querySelector('.loader'),\n};\n\nlet query = '';\nlet currentPage = 0;\nlet totalPages = 0;\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\niziToast.settings({\n  timeout: 3000,\n  transitionIn: 'fadeInDown',\n  position: 'topRight',\n});\n\nrefs.loader.classList.add('disable');\nrefs.btnLoad.classList.add('disable');\nrefs.formSearch.addEventListener('submit', onSubmit);\nrefs.btnLoad.addEventListener('click', onLoad);\n\nfunction onSubmit(e) {\n  e.preventDefault();\n  query = e.currentTarget.elements.searchQuery.value;\n  if (!query) {\n    return;\n  }\n  currentPage = 1;\n  refs.btnLoad.classList.add('disable');\n  refs.loader.classList.remove('disable');\n  refs.gallery.innerHTML = '';\n  fetchQuery(query, currentPage)\n    .then(response => {\n      if (response.data.totalHits) {\n        onSuccess(response.data.totalHits);\n        refs.gallery.insertAdjacentHTML(\n          'beforeend',\n          render(response.data.hits)\n        );\n        gallery.refresh();\n\n        totalPages = Math.ceil(\n          response.data.totalHits / response.data.hits.length\n        );\n        refs.btnLoad.classList.remove('disable');\n        if (currentPage === totalPages) {\n          refs.btnLoad.classList.add('disable');\n          onEndOfResults();\n        }\n      } else {\n        onError();\n      }\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.formSearch.reset();\n      refs.loader.classList.add('disable');\n    });\n}\n\nfunction onLoad() {\n  refs.btnLoad.classList.add('disable');\n  refs.loader.classList.remove('disable');\n  currentPage += 1;\n  fetchQuery(query, currentPage)\n    .then(response => {\n      refs.gallery.insertAdjacentHTML('beforeend', render(response.data.hits));\n      refs.btnLoad.classList.remove('disable');\n      if (currentPage === totalPages) {\n        refs.btnLoad.classList.add('disable');\n        onEndOfResults();\n      }\n      gallery.refresh();\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.loader.classList.add('disable');\n    });\n}\n\nfunction onSuccess(totalHits) {\n  iziToast.success({\n    title: 'OK',\n    message: `Hooray! We found ${totalHits} images.`,\n    iconUrl: iconSuccess,\n    theme: 'dark',\n    color: 'rgb(89, 161, 13)',\n  });\n}\n\nfunction onError() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    iconUrl: iconError,\n    theme: 'dark',\n    color: 'rgb(239, 64, 64)',\n  });\n}\n\nfunction onEndOfResults() {\n  iziToast.info({\n    title: 'Oh! No!',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n"],"names":["refs","query","currentPage","totalPages","gallery","SimpleLightbox","iziToast","onSubmit","onLoad","e","fetchQuery","response","onSuccess","render","onEndOfResults","onError","err","totalHits","iconSuccess","iconError"],"mappings":"4HAUA,MAAMA,EAAO,CACX,WAAY,SAAS,eAAe,aAAa,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,QAAS,SAAS,cAAc,uBAAuB,EACvD,OAAQ,SAAS,cAAc,SAAS,CAC1C,EAEA,IAAIC,EAAQ,GACRC,EAAc,EACdC,EAAa,EAEjB,MAAMC,EAAU,IAAIC,EAAe,aAAc,CAC/C,aAAc,MACd,aAAc,GAChB,CAAC,EAEDC,EAAS,SAAS,CAChB,QAAS,IACT,aAAc,aACd,SAAU,UACZ,CAAC,EAEDN,EAAK,OAAO,UAAU,IAAI,SAAS,EACnCA,EAAK,QAAQ,UAAU,IAAI,SAAS,EACpCA,EAAK,WAAW,iBAAiB,SAAUO,CAAQ,EACnDP,EAAK,QAAQ,iBAAiB,QAASQ,CAAM,EAE7C,SAASD,EAASE,EAAG,CACnBA,EAAE,eAAc,EAChBR,EAAQQ,EAAE,cAAc,SAAS,YAAY,MACxCR,IAGLC,EAAc,EACdF,EAAK,QAAQ,UAAU,IAAI,SAAS,EACpCA,EAAK,OAAO,UAAU,OAAO,SAAS,EACtCA,EAAK,QAAQ,UAAY,GACzBU,EAAWT,EAAOC,CAAW,EAC1B,KAAKS,GAAY,CACZA,EAAS,KAAK,WAChBC,EAAUD,EAAS,KAAK,SAAS,EACjCX,EAAK,QAAQ,mBACX,YACAa,EAAOF,EAAS,KAAK,IAAI,CACnC,EACQP,EAAQ,QAAO,EAEfD,EAAa,KAAK,KAChBQ,EAAS,KAAK,UAAYA,EAAS,KAAK,KAAK,MACvD,EACQX,EAAK,QAAQ,UAAU,OAAO,SAAS,EACnCE,IAAgBC,IAClBH,EAAK,QAAQ,UAAU,IAAI,SAAS,EACpCc,MAGFC,GAER,CAAK,EACA,MAAMC,GAAO,QAAQ,IAAIA,CAAG,CAAC,EAC7B,QAAQ,IAAM,CACbhB,EAAK,WAAW,QAChBA,EAAK,OAAO,UAAU,IAAI,SAAS,CACzC,CAAK,EACL,CAEA,SAASQ,GAAS,CAChBR,EAAK,QAAQ,UAAU,IAAI,SAAS,EACpCA,EAAK,OAAO,UAAU,OAAO,SAAS,EACtCE,GAAe,EACfQ,EAAWT,EAAOC,CAAW,EAC1B,KAAKS,GAAY,CAChBX,EAAK,QAAQ,mBAAmB,YAAaa,EAAOF,EAAS,KAAK,IAAI,CAAC,EACvEX,EAAK,QAAQ,UAAU,OAAO,SAAS,EACnCE,IAAgBC,IAClBH,EAAK,QAAQ,UAAU,IAAI,SAAS,EACpCc,KAEFV,EAAQ,QAAO,CACrB,CAAK,EACA,MAAMY,GAAO,QAAQ,IAAIA,CAAG,CAAC,EAC7B,QAAQ,IAAM,CACbhB,EAAK,OAAO,UAAU,IAAI,SAAS,CACzC,CAAK,CACL,CAEA,SAASY,EAAUK,EAAW,CAC5BX,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,oBAAoBW,CAAS,WACtC,QAASC,EACT,MAAO,OACP,MAAO,kBACX,CAAG,CACH,CAEA,SAASH,GAAU,CACjBT,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,QAASa,EACT,MAAO,OACP,MAAO,kBACX,CAAG,CACH,CAEA,SAASL,GAAiB,CACxBR,EAAS,KAAK,CACZ,MAAO,UACP,QAAS,4DACb,CAAG,CACH"}