{"version":3,"file":"commonHelpers.js","sources":["../src/components/refs.js","../src/components/url.js","../src/components/fetchAPI.js","../src/components/render.js","../src/components/appendImagesMarkup.js","../src/img/iconSuccess.svg","../src/img/iconError.svg","../src/components/notifications.js","../src/main.js"],"sourcesContent":["export const refs = {\n  formSearch: document.getElementById('search-form'),\n  gallery: document.querySelector('.gallery'),\n  btnLoad: document.querySelector('button[type=\"button\"]'),\n  loader: document.querySelector('.loader'),\n};\n","export const BASE_URL = 'https://pixabay.com/api/';\n","import axios from 'axios';\nimport { BASE_URL } from './url';\n\nconst apiKey = import.meta.env.VITE_API_KEY;\n\nexport class FetchAPI {\n  constructor() {\n    this.searchQuery = '';\n    this.currentPage = 1;\n    this.totalPages = null;\n  }\n\n  async fetchQuery() {\n    const response = await axios.get(`${BASE_URL}`, {\n      params: {\n        key: apiKey,\n        q: this.searchQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: this.currentPage,\n        per_page: 15,\n      },\n    });\n\n    if (response.status !== 200) {\n      throw new Error(response.statusText);\n    }\n\n    return response.data;\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  incrementPage() {\n    this.currentPage += 1;\n  }\n\n  resetPage() {\n    this.currentPage = 1;\n  }\n\n  totalNumberOfPages(totalPages, pageLength) {\n    this.totalPages = Math.ceil(totalPages / pageLength);\n  }\n}\n","export function render(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n  <div class=\"photo-card gallery__item\">\n    <a href=\"${largeImageURL}\" class=\"gallery__link\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    </a>\n    <div class=\"info\">\n      <p class=\"info-item\">\n        <b>Likes </b>${likes}\n      </p>\n      <p class=\"info-item\">\n        <b>Views </b>${views}\n      </p>\n      <p class=\"info-item\">\n        <b>Comments </b>${comments}\n      </p>\n      <p class=\"info-item\">\n        <b>Downloads </b>${downloads}\n      </p>\n    </div>\n  </div>\n`\n    )\n    .join('');\n}\n","import { refs } from './refs';\nimport { render } from './render';\n\nexport function appendImagesMarkup(hits) {\n  refs.gallery.insertAdjacentHTML('beforeend', render(hits));\n}\n","export default \"__VITE_ASSET__54aa501e__\"","export default \"__VITE_ASSET__e951fa8c__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { iconError, iconSuccess } from './icons';\n\niziToast.settings({\n  timeout: 3000,\n  transitionIn: 'fadeInDown',\n  position: 'topRight',\n});\n\nexport function onSuccess(totalHits) {\n  iziToast.success({\n    title: 'OK',\n    message: `Hooray! We found ${totalHits} images.`,\n    iconUrl: iconSuccess,\n    theme: 'dark',\n    color: 'rgb(89, 161, 13)',\n  });\n}\n\nexport function onError() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    iconUrl: iconError,\n    theme: 'dark',\n    color: 'rgb(239, 64, 64)',\n  });\n}\n\nexport function onEndOfResults() {\n  iziToast.info({\n    title: 'Oh! No!',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from './components/refs';\nimport { FetchAPI } from './components/fetchAPI';\nimport { appendImagesMarkup } from './components/appendImagesMarkup';\nimport { onEndOfResults, onError, onSuccess } from './components/notifications';\nimport './css/styles.css';\n\nconst fetchAPI = new FetchAPI();\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nrefs.loader.classList.add('disable');\nrefs.btnLoad.classList.add('disable');\nrefs.formSearch.addEventListener('submit', onSubmit);\nrefs.btnLoad.addEventListener('click', onLoad);\n\nfunction onSubmit(e) {\n  e.preventDefault();\n  refs.gallery.innerHTML = '';\n\n  fetchAPI.query = e.currentTarget.elements.searchQuery.value;\n  if (!fetchAPI.query) {\n    return;\n  }\n  fetchAPI.resetPage();\n\n  refs.btnLoad.classList.add('disable');\n  refs.loader.classList.remove('disable');\n\n  fetchAPI\n    .fetchQuery()\n    .then(({ totalHits, hits }) => {\n      if (totalHits) {\n        appendImagesMarkup(hits);\n        onSuccess(totalHits);\n        fetchAPI.totalNumberOfPages(totalHits, hits.length);\n        checkEndPage();\n        gallery.refresh();\n      } else {\n        onError();\n      }\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.formSearch.reset();\n      refs.loader.classList.add('disable');\n    });\n}\n\nfunction onLoad() {\n  refs.btnLoad.classList.add('disable');\n  refs.loader.classList.remove('disable');\n\n  fetchAPI.incrementPage();\n\n  fetchAPI\n    .fetchQuery()\n    .then(({ hits }) => {\n      appendImagesMarkup(hits);\n\n      const { height: cardHeight } = document\n        .querySelector('.gallery')\n        .firstElementChild.getBoundingClientRect();\n\n      window.scrollBy({\n        top: cardHeight * 2 + 190,\n        behavior: 'smooth',\n      });\n\n      checkEndPage();\n      gallery.refresh();\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.loader.classList.add('disable');\n    });\n}\n\nfunction checkEndPage() {\n  if (fetchAPI.currentPage === fetchAPI.totalPages) {\n    refs.btnLoad.classList.add('disable');\n    onEndOfResults();\n  } else {\n    refs.btnLoad.classList.remove('disable');\n  }\n}\n// //  variant 2\n\n// import axios from 'axios';\n// import iziToast from 'izitoast';\n// import 'izitoast/dist/css/iziToast.min.css';\n// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n// import fetchQuery from './js/pixabay-api';\n// import render from './js/render-functions';\n// import { iconSuccess, iconError } from './js/components';\n// import './css/styles.css';\n\n// const refs = {\n//   formSearch: document.getElementById('search-form'),\n//   gallery: document.querySelector('.gallery'),\n//   target: document.querySelector('.js-guard'),\n//   loader: document.querySelector('.loader'),\n// };\n\n// let query = '';\n// let currentPage = 0;\n// let totalPages = 0;\n\n// const gallery = new SimpleLightbox('.gallery a', {\n//   captionsData: 'alt',\n//   captionDelay: 250,\n// });\n\n// iziToast.settings({\n//   timeout: 3000,\n//   transitionIn: 'fadeInDown',\n//   position: 'topRight',\n// });\n\n// const options = {\n//   root: null,\n//   rootMargin: '300px',\n//   threshold: 1.0,\n// };\n// const observer = new IntersectionObserver(onLoad, options);\n// refs.loader.classList.add('disable');\n// refs.formSearch.addEventListener('submit', onSubmit);\n\n// function onSubmit(e) {\n//   e.preventDefault();\n//   query = e.currentTarget.elements.searchQuery.value;\n//   if (!query) {\n//     return;\n//   }\n//   observer.unobserve(refs.target);\n//   currentPage = 1;\n//   refs.loader.classList.remove('disable');\n//   refs.gallery.innerHTML = '';\n//   fetchQuery(query, currentPage)\n//     .then(response => {\n//       if (response.data.totalHits) {\n//         onSuccess(response.data.totalHits);\n//         refs.gallery.insertAdjacentHTML(\n//           'beforeend',\n//           render(response.data.hits)\n//         );\n//         observer.observe(refs.target);\n//         gallery.refresh();\n\n//         totalPages = Math.ceil(\n//           response.data.totalHits / response.data.hits.length\n//         );\n\n//         if (currentPage === totalPages) {\n//           observer.unobserve(refs.target);\n//           onEndOfResults();\n//         }\n//       } else {\n//         onError();\n//       }\n//     })\n//     .catch(err => console.log(err))\n//     .finally(() => {\n//       refs.formSearch.reset();\n//       refs.loader.classList.add('disable');\n//     });\n// }\n\n// function onLoad(entries, observer) {\n//   entries.forEach(entry => {\n//     if (entry.isIntersecting) {\n//       currentPage += 1;\n//       fetchQuery(query, currentPage)\n//         .then(response => {\n//           refs.gallery.insertAdjacentHTML(\n//             'beforeend',\n//             render(response.data.hits)\n//           );\n\n//           if (currentPage === totalPages) {\n//             observer.unobserve(refs.target);\n//             onEndOfResults();\n//           }\n//           gallery.refresh();\n//         })\n//         .catch(err => console.log(err));\n//     }\n//   });\n// }\n\n// function onSuccess(totalHits) {\n//   iziToast.success({\n//     title: 'OK',\n//     message: `Hooray! We found ${totalHits} images.`,\n//     iconUrl: iconSuccess,\n//     theme: 'dark',\n//     color: 'rgb(89, 161, 13)',\n//   });\n// }\n\n// function onError() {\n//   iziToast.error({\n//     title: 'Error',\n//     message:\n//       'Sorry, there are no images matching your search query. Please try again!',\n//     iconUrl: iconError,\n//     theme: 'dark',\n//     color: 'rgb(239, 64, 64)',\n//   });\n// }\n\n// function onEndOfResults() {\n//   iziToast.info({\n//     title: 'Oh! No!',\n//     message: \"We're sorry, but you've reached the end of search results.\",\n//   });\n// }\n"],"names":["refs","BASE_URL","apiKey","FetchAPI","response","axios","newQuery","totalPages","pageLength","render","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","appendImagesMarkup","hits","iconSuccess","iconError","iziToast","onSuccess","totalHits","onError","onEndOfResults","fetchAPI","gallery","SimpleLightbox","onSubmit","onLoad","e","checkEndPage","err","cardHeight"],"mappings":"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"}